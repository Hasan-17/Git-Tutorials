Utility functions for my  updated version